<div id="all-missions-container" class="h-full w-full">
    <template id="all-missions-layout-template">
        <div class="flex flex-col h-full bg-slate-100 overflow-y-auto w-full">
            <div class="p-2 text-center bg-white shadow-sm z-10 sticky top-0 flex justify-between items-center">
                <button class="btn text-sm" hx-get="partials/splash.html" hx-target="#app-content"
                    hx-push-url="?view=splash" hx-swap="innerHTML">Back</button>
                <div class="font-bold text-lg">All Missions</div>
                <div class="w-[42px]"></div> <!-- Spacer for centering -->
            </div>
            <div class="flex flex-col items-center justify-center p-4 gap-4 js-all-missions-list">
                <!-- Mission Sections go here -->
            </div>
        </div>
    </template>
    <script>
        (function () {
            const B = window.Beerio;
            const container = document.getElementById('all-missions-container');
            const layout = B.helpers.instantiateTemplate('all-missions-layout-template');
            const listContainer = layout.querySelector('.js-all-missions-list');

            // Helper to add a header
            const addHeader = (text) => {
                const h2 = document.createElement('h2');
                h2.className = "text-xl font-bold mt-4 mb-2 text-gray-700 w-full text-center border-b border-gray-300 pb-2";
                h2.textContent = text;
                listContainer.appendChild(h2);
            };

            // 1. Regular Missions
            if (B.state.missions.missions && B.state.missions.missions.length > 0) {
                addHeader("Solo Missions");
                B.state.missions.missions.forEach(mission => {
                    listContainer.appendChild(B.helpers.renderMissionCard(mission, 'example', 0));
                });
            }

            // 2. Co-op Gran Prix
            if (B.state.missions.coop_granprix && B.state.missions.coop_granprix.length > 0) {
                addHeader("Co-op Grand Prix");
                B.state.missions.coop_granprix.forEach(mission => {
                    listContainer.appendChild(B.helpers.renderMissionCard(mission, 'example', 0));
                });
            }

            // 3. Co-op Single
            if (B.state.missions.coop_single && B.state.missions.coop_single.length > 0) {
                addHeader("Co-op Single Race");
                B.state.missions.coop_single.forEach(mission => {
                    listContainer.appendChild(B.helpers.renderMissionCard(mission, 'example', 0));
                });
            }

            container.innerHTML = '';
            container.appendChild(layout);
            htmx.process(container);
        })();
    </script>
</div>